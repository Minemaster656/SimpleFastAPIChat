<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat</title>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it-emoji/dist/markdown-it-emoji.min.js"></script>

    <link rel="stylesheet" href="/static/css/styles.css" />
    <script src="/static/js/randomThings.js"></script>
  </head>

  <body>
    {% include 'parts/avamoji_selection.html' %}
    <button id="themeToggle">
      <span class="light-icon">üåû</span>
      <span class="dark-icon">üåô</span>
    </button>

    <div id="main">
      <div id="auth-zone">
        <!-- <label for="nick" onclick="auth()">–í–∞—à –Ω–∏–∫</label> -->
        <div id="profile-setup">
          <div id="profile-setup-buttons">
            <button id="auth">–ó–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è / –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
            <!-- <button id="update">–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button> -->
            <button id="show-hide-customise">
              –°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—é
            </button>
          </div>
          <div id="customisation">
            
            <input type="text" name="nick" id="nick" placeholder="–í–∞—à –Ω–∏–∫" /> 
            <button id="randomNicknameButton">üé≤</button>
            <script>
              document.getElementById("randomNicknameButton").addEventListener("click", () => {
                const randomNickname = getRandomPhrase();
                document.getElementById("nick").value = randomNickname;
              });
            </script>
            <!-- <label for="avatar">–≠–º–æ–¥–∑–∏ –∞–≤–∞—Ç–∞—Ä–∞</label>
                    <select name="avatar" id="avatar"></select> -->
            <div id="avatar-emoji-selection">
              <label for="avatar-emoji">–≠–º–æ–¥–∑–∏ –∞–≤–∞—Ç–∞—Ä–∞</label>
              <input
                type="text"
                name="avatar"
                id="avatar-emoji"
                maxlength="2"
                placeholder="–í–≤–µ–¥–∏—Ç–µ —ç–º–æ–¥–∑–∏"
              />
              <button id="emojiPickerButton">üòé</button>
              <script>
                document.getElementById("emojiPickerButton").addEventListener("click", () => {
                  callEmojiKeyboard(document.getElementById("avatar-emoji"), true, true);
                });
              </script>
              <button id="randomEmojiButton">üé≤</button>
              <script>
                document.getElementById("randomEmojiButton").addEventListener("click", () => {
                  const randomEmoji = getRandomEmoji();
                  document.getElementById("avatar-emoji").value = randomEmoji;
                });
              </script>
            </div>

            <div id="avatar-colors">
              <div id="avatar-color-top-container">
                <label for="avatar-color-top"
                  >–í–µ—Ä—Ö–Ω–∏–π —Ü–≤–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∞–≤–∞—Ç–∞—Ä–∞</label
                >
                <input
                  type="color"
                  name="avatar-color-top"
                  id="avatar-color-top"
                />
              </div>
              <div id="avatar-color-bottom-container">
                <label for="avatar-color-bottom"
                  >–ù–∏–∂–Ω–∏–π —Ü–≤–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∞–≤–∞—Ç–∞—Ä–∞</label
                >
                <input
                  type="color"
                  name="avatar-color-bottom"
                  id="avatar-color-bottom"
                />
              </div>
            <button id="randomColorButton">üé≤</button>
            <script>
              document.getElementById("randomColorButton").addEventListener("click", () => {
                const randomTopColor = `#${Math.floor(Math.random() * 16777215).toString(16)}`;
                const randomBottomColor = `#${Math.floor(Math.random() * 16777215).toString(16)}`;
                document.getElementById("avatar-color-top").value = randomTopColor;
                document.getElementById("avatar-color-bottom").value = randomBottomColor;
                console.log("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–µ—Ä—Ö–Ω–∏–π —Ü–≤–µ—Ç:", randomTopColor);
                console.log("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∏–∂–Ω–∏–π —Ü–≤–µ—Ç:", randomBottomColor);
              });
            </script>
            </div>
          </div>
        </div>

        <div id="not-connected">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</div>
        <label for="servers">–°–µ—Ä–≤–µ—Ä —á–∞—Ç–∞</label>
        <select name="servers" id="servers">
          <option value="kihre.xyz:6969" selected>–ì–ª–∞–≤–Ω—ã–π</option>

          <option value="localhost:8000">–õ–æ–∫–∞–ª—å–Ω—ã–π 0</option>
          <option value="localhost:8001">–õ–æ–∫–∞–ª—å–Ω—ã–π 1</option>
        </select>
        <button id="soundToggle">üîä</button>
        <script>
          let isMuted = false;
          const soundToggle = document.getElementById("soundToggle");

          soundToggle.addEventListener("click", () => {
            isMuted = !isMuted;
            soundToggle.innerText = isMuted ? "üîá" : "üîä";
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞
            console.log(isMuted ? "–ó–≤—É–∫ –≤—ã–∫–ª—é—á–µ–Ω" : "–ó–≤—É–∫ –≤–∫–ª—é—á–µ–Ω");
          });
        </script>
      </div>

      <h1>DurkaChat</h1>

      <!-- <ul id='messages'>
        </ul> -->
      <div id="messages" class="checkerboard-bg">
        <!--<div class="message">
                <div class="senderdata">
                    <div class="avatar" style="background: linear-gradient(45deg, rgb(255, 0, 0), rgb(0, 0, 255));">
                        ü•Ω
                    </div>
                    <div class="message-time-and-sender">
                        <span class="sender-name">Test</span>
                        <div class="timestamp">
                            12.12.2024, 18:58
                        </div>
                    </div>
                </div>
                <div class="messagecontent">
                    –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ 97–∞–ø—Ä–≤—ã–º—Ñ —ã–ø—Ñ—Å–≤–æ Lorem ipsum dolor sit amet consectetur adipisicing elit. Quaerat
                    consequatur sed, nam laudantium soluta asperiores repellat vel provident dolor vitae qui, mollitia
                    laboriosam, consequuntur assumenda delectus? Perferendis, sit voluptatum. Aliquid.
                </div>
            </div>
            <div class="message">
                <div class="senderdata">
                    <div class="avatar"
                        style="background: linear-gradient(0deg, rgba(163,151,163,1) 0%, rgba(232,247,249,1) 100%);">
                        ‚öô
                    </div>
                    <div class="message-time-and-sender">
                        <span class="sender-name">System</span>
                        <div class="timestamp">
                            12.12.2024, 18:58
                        </div>
                    </div>
                </div>
                <div class="messagecontent">
                    –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —á–µ–≥–æ-—Ç–æ
                </div>
            </div>
            <div class="message error">
                <div class="senderdata">
                    <div class="avatar"
                        style="background: linear-gradient(0deg, rgba(163,151,163,1) 0%, rgba(232,247,249,1) 100%);">
                        ‚öô
                    </div>
                    <div class="message-time-and-sender">
                        <span class="sender-name">System</span>
                        <div class="timestamp">
                            12.12.2024, 18:58
                        </div>
                    </div>
                </div>
                <div class="messagecontent">
                    –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —á–µ–≥–æ-—Ç–æ
                </div>
            </div> -->
      </div>
      <form action="" onsubmit="submitMessage(event)" id="typer">
        <textarea
          id="messageText"
          autocomplete="off"
          placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ /help"
          rows="3"
          style="width: 100%"
        ></textarea> 
        <button id="emojiButton">üòä</button>
        <button>–û—Ç–ø—Ä–∞–≤–∏—Ç—å üöÄ</button>
        <script>
          document.getElementById("emojiButton").addEventListener("click", () => {
            callEmojiKeyboard(document.getElementById("messageText"), true, false);
          });
        </script>
        <p>Shift+Enter –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ 2, Ctrl+Enter –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ 1, Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è <a href='https://lifehacker.ru/chto-takoe-markdown/'>Markdown</a></p>
      </form>
      
    </div>
    <div style="position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px;">
        <a href="#customisation" style="background-color: #007bff; color: white; padding: 10px; border-radius: 5px; text-align: center; text-decoration: none;">
            ‚¨ÜÔ∏è –í–≤–µ—Ä—Ö
        </a>
        <a href="#typer" style="background-color: #007bff; color: white; padding: 10px; border-radius: 5px; text-align: center; text-decoration: none;">
            ‚¨áÔ∏è –í–Ω–∏–∑
        </a>
    </div>
    <audio
      src="/static/sounds/message.mp3"
      id="message-sound"
      style="display: none"
    ></audio>
    <audio
      src="/static/sounds/join.mp3"
      id="join-sound"
      style="display: none"
    ></audio>
    <audio
      src="/static/sounds/leave.mp3"
      id="leave-sound"
      style="display: none"
    ></audio>
    <audio
      src="/static/sounds/connect.mp3"
      id="connect-sound"
      style="display: none"
    ></audio>
    <script src="/static/js/chat_main.js"></script>
  </body>
</html>
